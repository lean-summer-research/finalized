\chapter{Green's Relations in Finite Semigroups}

% Begin MyProject/Semigroup/Green/Finite.lean
Important lemma: (\ref{lem:exists-pow-sandwich}).

\begin{lemma}[Equivalence of D and J Relations in Finite Semigroups]
\label{lem:d-j-theorem}
In a finite semigroup, the $\mathcal{D}$ and $\mathcal{J}$ relations are equivalent. That is, for any two elements $x, y \in S$, $x \mathcal{D} y$ if and only if $x \mathcal{J} y$.
\lean{Semigroup.JEquiv.to_dEquiv, Semigroup.dEquiv_iff_jEquiv}
\leanok
\uses{def:greens-relations, lem:exists-pow-sandwich}
\end{lemma}

\begin{proof}
\leanok
The forward direction, that $x \mathcal{D} y$ implies $x \mathcal{J} y$, holds in any semigroup, not just finite ones. This is because if $x \mathcal{D} y$, there exists $z$ such that $x \mathcal{R} z$ and $z \mathcal{L} y$. These relations imply $x \leq_{\mathcal{J}} z$ and $z \leq_{\mathcal{J}} y$, and by transitivity, $x \leq_{\mathcal{J}} y$. A symmetric argument shows $y \leq_{\mathcal{J}} x$, so $x \mathcal{J} y$.

The reverse direction relies on the semigroup being finite. TODO: FINISH PROOF
\uses{def:greens-relations, lem:exists-pow-sandwich}
\end{proof}

\begin{lemma}[J-Equivalence Strengthening Preorders]
\label{lem:j-strengthening}
In a finite semigroup, if two elements are $\mathcal{J}$-equivalent, then a one-sided preorder implies the corresponding one-sided equivalence. Specifically, if $x \mathcal{J} y$ and $x \leq_{\mathcal{R}} y$, then $x \mathcal{R} y$. Similarly, if $x \mathcal{J} y$ and $x \leq_{\mathcal{L}} y$, then $x \mathcal{L} y$.
\lean{Semigroup.REquiv.of_rPreorder_and_jEquiv, Semigroup.LEquiv.of_lPreorder_and_jEquiv}
\leanok
\uses{def:greens-relations, lem:d-j-theorem, lem:exists-pow-sandwich}
\end{lemma}

\begin{proof}
\leanok
Suppose $x \mathcal{J} y$ and $x \leq_{\mathcal{R}} y$. Since we are in a finite semigroup, $x \mathcal{J} y$ implies $x \mathcal{D} y$ by \ref{lem:d-j-theorem}. TODO: FINISH PROOF 
\uses{def:greens-relations, lem:d-j-theorem, lem:exists-pow-sandwich}
\end{proof}

\begin{lemma}[H-Equivalence from Sandwiching]
\label{lem:h-of-sandwich}
In a finite semigroup, if an element $x$ can be written as $x = uxv$ for some $u, v \in S$, then $x$ is $\mathcal{H}$-equivalent to both $ux$ and $xv$.
\lean{Semigroup.HEquiv.of_eq_sandwich}
\leanok
\uses{def:greens-relations, lem:j-strengthening, lem:exists-pow-sandwich}
\end{lemma}

\begin{proof}
\leanok
TODO
\uses{def:greens-relations, lem:j-strengthening, lem:exists-pow-sandwich}
\end{proof}

% End MyProject/Semigroup/Green/Finite.lean
